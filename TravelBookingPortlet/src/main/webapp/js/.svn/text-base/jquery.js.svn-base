(function(A){A.fn.closeDOMWindow=function(B){if(!B){B={}}var C=function(D){if(B.anchoredClassName){var G=A("."+B.anchoredClassName);G.fadeOut("fast",function(){if(A.fn.draggable){G.draggable("destory").trigger("unload").remove()}else{G.trigger("unload").remove()}});if(B.functionCallOnClose){B.functionCallAfterClose()}}else{var E=A("#DOMWindowOverlay");var F=A("#DOMWindow");E.fadeOut("fast",function(){E.trigger("unload").unbind().remove()});F.fadeOut("fast",function(){});A(window).unbind("scroll.DOMWindow");A(window).unbind("resize.DOMWindow");if(A.fn.openDOMWindow.isIE6){A("#DOMWindowIE6FixIframe").remove()}if(B.functionCallOnClose){B.functionCallAfterClose()}}};if(B.eventType){return this.each(function(D){A(this).bind(B.eventType,function(){C(this);return false})})}else{C()}};A.closeDOMWindow=function(B){A.fn.closeDOMWindow(B)};A.fn.openDOMWindow=function(H){var G=A.fn.openDOMWindow;G.defaultsSettings={anchoredClassName:"",anchoredSelector:"",borderColor:"#ccc",borderSize:"4",draggable:0,eventType:null,fixedWindowY:100,functionCallOnOpen:null,functionCallOnClose:null,height:500,loader:0,loaderHeight:0,loaderImagePath:"",loaderWidth:0,modal:0,overlay:1,positionLeft:0,positionTop:0,positionType:"centered",width:700,windowBGImage:null,windowHTTPType:"get",windowPadding:30,windowSource:"inline",windowSourceID:"",windowSourceURL:"",windowSourceAttrURL:"href"};var F=A.extend({},A.fn.openDOMWindow.defaultsSettings,H||{});G.viewPortHeight=function(){return self.innerHeight||document.documentElement.clientHeight||document.body.clientHeight};G.viewPortWidth=function(){return self.innerWidth||document.documentElement.clientWidth||document.body.clientWidth};G.scrollOffsetHeight=function(){return self.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop};G.scrollOffsetWidth=function(){return self.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft};G.isIE6=typeof document.body.style.maxHeight==="undefined";var B=function(){var N=A("#DOMWindowOverlay");if(G.isIE6){var M=document.documentElement.offsetHeight+document.documentElement.scrollTop-4;var O=document.documentElement.offsetWidth-21;N.css({height:M+"px",width:O+"px"})}else{N.css({height:"100%",width:"100%",position:"fixed","background-image":"url(/tcportal/images/newHome/OverlayBg.png)","background-repeat":"repeat"})}};var D=function(){var M=document.documentElement.offsetHeight+document.documentElement.scrollTop-4;var N=document.documentElement.offsetWidth-21;A("#DOMWindowIE6FixIframe").css({height:M+"px",width:N+"px"})};var K=function(){var M=A("#DOMWindow");if(F.height+50>G.viewPortHeight()){M.css("left",Math.round(G.viewPortWidth()/2)+G.scrollOffsetWidth()-Math.round((M.outerWidth())/2))}else{M.css("left",Math.round(G.viewPortWidth()/2)+G.scrollOffsetWidth()-Math.round((M.outerWidth())/2));M.css("top",Math.round(G.viewPortHeight()/2)+G.scrollOffsetHeight()-Math.round((M.outerHeight())/2))}};var J=function(){var M=A("#DOMWindowLoader");if(G.isIE6){M.css({left:Math.round(G.viewPortWidth()/2)+G.scrollOffsetWidth()-Math.round((M.innerWidth())/2),position:"absolute"});M.css({top:Math.round(G.viewPortHeight()/2)+G.scrollOffsetHeight()-Math.round((M.innerHeight())/2),position:"absolute"})}else{M.css({left:"50%",top:"50%",position:"fixed"})}};var L=function(){var M=A("#DOMWindow");M.css("left",F.positionLeft+G.scrollOffsetWidth());M.css("top",+F.positionTop+G.scrollOffsetHeight())};var I=function(M){if(arguments[0]){A("."+M+" #DOMWindowLoader").remove();A("."+M+" #DOMWindowContent").fadeIn("fast",function(){if(F.functionCallOnOpen){F.functionCallOnOpen()}});A("."+M+".closeDOMWindow").click(function(){A.closeDOMWindow();return false})}else{A("#DOMWindowLoader").remove();A("#DOMWindow").fadeIn("fast",function(){if(F.functionCallOnOpen){F.functionCallOnOpen()}});A("#DOMWindow .closeDOMWindow").click(function(){A.closeDOMWindow();return false})}};var C=function(M){var N={};M.replace(/b([^&=]*)=([^&=]*)b/g,function(O,P,Q){if(typeof N[P]!="undefined"){N[P]+=","+Q}else{N[P]=Q}});return N};var E=function(M){F.windowSourceID=A(M).attr("href")||F.windowSourceID;F.windowSourceURL=A(M).attr(F.windowSourceAttrURL)||F.windowSourceURL;F.windowBGImage=F.windowBGImage?"background-image:url("+F.windowBGImage+")":"";var T,N;if(F.positionType=="anchored"){var S=A(F.anchoredSelector).position();var P=S.left+F.positionLeft;var Q=S.top+F.positionTop;A("body").append('<div class="'+F.anchoredClassName+'" style="'+F.windowBGImage+";background-repeat:no-repeat;padding:"+F.windowPadding+"px;position:absolute;top:"+Q+"px;left:"+P+"px;height:"+F.height+"px;width:"+F.width+"px;background-color:"+F.windowBGColor+";border:"+F.borderSize+"px solid "+F.borderColor+';z-index:10001"><div id="DOMWindowContent" style="display:none"></div></div>');if(F.loader&&F.loaderImagePath!==""){A("."+F.anchoredClassName).append('<div id="DOMWindowLoader" style="width:'+F.loaderWidth+"px;height:"+F.loaderHeight+'px;"><img src="'+F.loaderImagePath+'" /></div>')}if(A.fn.draggable){if(F.draggable){A("."+F.anchoredClassName).draggable({cursor:"move"})}}switch(F.windowSource){case"inline":A("."+F.anchoredClassName+" #DOMWindowContent").append(A(F.windowSourceID).children());A("."+F.anchoredClassName).unload(function(){A("."+F.windowSourceID).append(A("."+F.anchoredClassName+" #DOMWindowContent").children())});I(F.anchoredClassName);break;case"iframe":A("."+F.anchoredClassName+" #DOMWindowContent").append('<iframe frameborder="0" hspace="0" wspace="0" src="'+F.windowSourceURL+'" name="DOMWindowIframe'+Math.round(Math.random()*1000)+'" style="width:100%;height:100%;border:none;background-color:#fff;" class="'+F.anchoredClassName+'Iframe" ></iframe>');A("."+F.anchoredClassName+"Iframe").load(I(F.anchoredClassName));break;case"ajax":if(F.windowHTTPType=="post"){if(F.windowSourceURL.indexOf("?")!==-1){T=F.windowSourceURL.substr(0,F.windowSourceURL.indexOf("?"));N=C(F.windowSourceURL)}else{T=F.windowSourceURL;N={}}A("."+F.anchoredClassName+" #DOMWindowContent").load(T,N,function(){I(F.anchoredClassName)})}else{if(F.windowSourceURL.indexOf("?")==-1){F.windowSourceURL+="?"}A("."+F.anchoredClassName+" #DOMWindowContent").load(F.windowSourceURL+"&random="+(new Date().getTime()),function(){I(F.anchoredClassName)})}break}}else{if(F.overlay){A("body").append('<div id="DOMWindowOverlay" style="z-index:10000;display:none;position:absolute;top:0;left:0;background-color:'+F.overlayColor+";filter:alpha(opacity="+F.overlayOpacity+");-moz-opacity: 0."+F.overlayOpacity+";opacity: 0."+F.overlayOpacity+';"></div>');if(G.isIE6){A("body").append('<iframe id="DOMWindowIE6FixIframe"  src="blank.html"  style="width:100%;height:100%;z-index:9999;position:absolute;top:0;left:0;filter:alpha(opacity=0);"></iframe>');D()}B();var O=A("#DOMWindowOverlay");O.fadeIn("fast");if(!F.modal){O.click(function(){A.closeDOMWindow()})}}if(F.loader&&F.loaderImagePath!==""){A("body").append('<div id="DOMWindowLoader" style="z-index:10002;width:'+F.loaderWidth+"px;height:"+F.loaderHeight+'px;"><img src="'+F.loaderImagePath+'" /></div>');J()}A("body").append('<div id="DOMWindow" style="background-repeat:no-repeat;'+F.windowBGImage+";padding:"+F.windowPadding+"px;display:none;height:"+F.height+"px;width:"+F.width+"px;background-color:"+F.windowBGColor+";border:"+F.borderSize+"px solid "+F.borderColor+'; position:absolute;z-index:10001"></div>');var R=A("#DOMWindow");switch(F.positionType){case"centered":K();if(F.height+50>G.viewPortHeight()){R.css("top",(F.fixedWindowY+G.scrollOffsetHeight())+"px")}break;case"absolute":R.css({top:(F.positionTop+G.scrollOffsetHeight())+"px",left:(F.positionLeft+G.scrollOffsetWidth())+"px"});if(A.fn.draggable){if(F.draggable){R.draggable({cursor:"move"})}}break;case"fixed":L();break;case"anchoredSingleWindow":var S=A(F.anchoredSelector).position();var P=S.left+F.positionLeft;var Q=S.top+F.positionTop;R.css({top:Q+"px",left:P+"px"});break}A(window).bind("scroll.DOMWindow",function(){if(F.overlay){B()}if(G.isIE6){D()}if(F.positionType=="centered"){K()}if(F.positionType=="fixed"){L()}});A(window).bind("resize.DOMWindow",function(){if(G.isIE6){D()}if(F.overlay){B()}if(F.positionType=="centered"){K()}});switch(F.windowSource){case"inline":R.append(A(F.windowSourceID).children());R.unload(function(){A(F.windowSourceID).append(R.children())});I();break;case"iframe":R.append('<iframe frameborder="0" hspace="0" wspace="0" src="'+F.windowSourceURL+'" name="DOMWindowIframe'+Math.round(Math.random()*1000)+'" style="width:100%;height:100%;border:none;background-color:#fff;" id="DOMWindowIframe" ></iframe>');A("#DOMWindowIframe").load(I());break;case"ajax":if(F.windowHTTPType=="post"){if(F.windowSourceURL.indexOf("?")!==-1){T=F.windowSourceURL.substr(0,F.windowSourceURL.indexOf("?"));N=C(F.windowSourceURL)}else{T=F.windowSourceURL;N={}}R.load(T,N,function(){I()})}else{if(F.windowSourceURL.indexOf("?")==-1){F.windowSourceURL+="?"}R.load(F.windowSourceURL+"&random="+(new Date().getTime()),function(){I()})}break}}};if(F.eventType){return this.each(function(M){A(this).bind(F.eventType,function(){E(this);return false})})}else{E()}};A.openDOMWindow=function(B){A.fn.openDOMWindow(B)}})(jQuery);